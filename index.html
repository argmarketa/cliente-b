<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Club VIP</title>
  
  <meta name="facebook-domain-verification" content="qx1zho2wixswe5pr0ill7z3aecxjcp" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="estilo.css">
  <link rel="icon" type="image/png" href="img/favicon.png">

  <style>
    body {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); /* Fondo moderno oscuro */
      color: white;
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      text-align: center;
    }
    
    .container {
      width: 90%;
      max-width: 500px;
      padding: 20px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Estilo del Logo (Mantiene IDs para que funcione tu script de marcas) */
    .logo-text {
      font-size: 1.2rem; 
      font-weight: bold; 
      margin-bottom: 5px; 
      text-transform: uppercase; 
      letter-spacing: 2px;
      visibility: hidden; /* Se hace visible con el script */
    }

    /* LA IMAGEN DE LA CHICA FELIZ */
    .hero-image {
      width: 100%;
      max-width: 350px; /* Tama침o controlado */
      height: auto;
      border-radius: 15px;
      margin: 10px auto 20px auto;
      border: 3px solid #00ff88;
      box-shadow: 0 0 25px rgba(0, 255, 136, 0.2);
      object-fit: cover;
    }

    .headline {
      font-size: 1.8rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 10px;
    }

    .sub-headline {
      font-size: 0.95rem;
      color: #ccc;
      margin-bottom: 25px;
      padding: 0 10px;
    }

    .card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 25px 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      width: 100%;
      box-sizing: border-box;
    }

    .popup-button {
      background: #00ff88; /* Verde Ne칩n */
      color: #004d2c;
      border: none;
      padding: 18px 20px;
      font-size: 1.3rem;
      font-weight: 900;
      border-radius: 50px;
      cursor: pointer;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: transform 0.2s;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.4);
      animation: pulse 2s infinite;
      text-transform: uppercase;
    }

    .popup-button:active {
      transform: scale(0.95);
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7); }
      70% { box-shadow: 0 0 0 15px rgba(0, 255, 136, 0); }
      100% { box-shadow: 0 0 0 0 rgba(0, 255, 136, 0); }
    }

    .social-proof {
      margin-top: 15px;
      font-size: 0.85rem;
      color: #bbb;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .dot {
      height: 8px;
      width: 8px;
      background-color: #00ff88;
      border-radius: 50%;
      display: inline-block;
    }

    .metodos-pago {
      margin-top: 30px;
      opacity: 0.8;
    }
    .metodos-pago img {
      height: 25px;
      margin: 0 5px;
      background: white;
      padding: 2px;
      border-radius: 4px;
    }
  </style>

  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');

    fbq('init', '1946841772846486'); 
    fbq('track', 'PageView');
  </script>
</head>

<body>
  
  <div class="container">
    
    <h1 class="logo-text" id="logoContainer">
      <span class="logo-emoji" id="brandEmoji">游눑</span>
      <span class="logo-text-fill" id="brandName">CLUB VIP</span>
    </h1>

    <img src="img/chica-feliz.png" alt="Cliente Feliz" class="hero-image">

    <h1 class="headline">
      Tu acceso est치 listo. <br>
      <span style="color: #00ff88;">쮼st치s preparada?</span>
    </h1>

    <p class="sub-headline">
      Hac칠 como miles de personas que ya descubrieron la experiencia. Atenci칩n 24/7 y retiros r치pidos. 游녢
    </p>

    <div class="card">
      <button class="popup-button" id="whatsappButton">
        <span>RECLAMAR MI ACCESO 游꾸</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 16 16">
          <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592z"/>
        </svg>
      </button>

      <div class="social-proof">
        <div class="dot"></div>
        <span>+18 personas ingresaron en los 칰ltimos 5 min.</span>
      </div>
    </div>

    <div class="metodos-pago">
      <div class="iconos-pago">
        <img src="img/8043680.png" alt="Transferencia">
        <img src="img/Mercado Pago.png" alt="MP">
        <img src="img/logo-large.png" alt="Banco">
        <img src="img/logo-cuenta-dni.png" alt="DNI">
      </div>
    </div>

  </div>

  <script>
    // ==========================================
    // 游 0. ROTADOR DE WHATSAPP (CLIENTE B)
    // ==========================================
    const WHATSAPP_NUMBERS = [
      "5492235575929",
      "5492233408708",
      "5492235307609",
    ];

    function getRandomWhatsApp() {
      const randomIndex = Math.floor(Math.random() * WHATSAPP_NUMBERS.length);
      return WHATSAPP_NUMBERS[randomIndex];
    }

    // ==========================================
    // 游꿠 1. CONFIGURACI칍N DE MARCAS (PRESERVADA)
    // ==========================================
    const BRANDS = {
      'imperio': { name: 'IMPERIO ESMERALDA', emoji: '游눑', color: '#00ff88' },
      'rubi': { name: 'IMPERIO RUB칈', emoji: '仇벒잺', color: '#ff3131' },
      'default': { name: 'CLUB VIP', emoji: '游눑', color: '#00ff88' } 
    };

    function applyBranding() {
      const params = new URLSearchParams(window.location.search);
      const brandKey = params.get('marca') || 'default';
      const brand = BRANDS[brandKey] || BRANDS['default'];

      const nameEl = document.getElementById('brandName');
      const emojiEl = document.getElementById('brandEmoji');

      if(nameEl) nameEl.textContent = brand.name;
      if(emojiEl) emojiEl.textContent = brand.emoji;
      
      if(nameEl) {
        nameEl.style.color = brand.color;
        nameEl.style.textShadow = `0 0 20px ${brand.color}80`;
      }

      const container = document.getElementById('logoContainer');
      if(container) container.style.visibility = 'visible';
      
      document.title = brand.emoji + " " + brand.name;
    }

    // Ejecutar branding
    applyBranding();

    // ==========================================
    // 丘뙖잺 2. CONEXI칍N DIRECTA CON EXCEL (CLIENTE B)
    // ==========================================
    
    // URL DEL SHEET ORIGINAL DEL CLIENTE B
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbyEP1G0v2Rbt-8R_x5h45gLDwyTMXxghPUqZzluBBA1d6BMqVTYPxvD0DCAG768E59L/exec"; 

    let btn;

    // --- Funciones Auxiliares ---
    function getCookie(name) {
      const match = document.cookie.match(new RegExp("(^| )" + name + "=([^;]+)"));
      return match ? match[2] : "";
    }
    function setCookie(name, value) {
      document.cookie = `${name}=${value}; path=/; max-age=63072000`;
    }
    function ensureFBP() {
      let fbp = getCookie("_fbp");
      if (!fbp) {
        fbp = `fb.1.${Date.now()}.${Math.floor(Math.random() * 1e10)}`;
        setCookie("_fbp", fbp);
      }
      return fbp;
    }
    function ensureFBC() {
      const fbclid = new URLSearchParams(window.location.search).get("fbclid");
      if (!fbclid) return "";
      const fbc = `fb.1.${Date.now()}.${fbclid}`;
      setCookie("_fbc", fbc);
      return fbc;
    }
    function generateShortID() {
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let id = "";
      for (let i = 0; i < 5; i++) id += chars.charAt(Math.floor(Math.random() * chars.length));
      return id;
    }
    function getOrCreateClickID() {
      const stored = localStorage.getItem("click_id");
      if (stored) return stored;
      const id = generateShortID();
      localStorage.setItem("click_id", id);
      return id;
    }

    // --- Env칤o de Datos al Sheet ---
    function safeSend(payload) {
      if (!SHEET_URL || SHEET_URL.includes("PEGAR_AQUI")) {
        console.warn("丘멆잺 URL de Sheet no configurada.");
        return;
      }
      try {
        const blob = new Blob([JSON.stringify(payload)], {type : 'text/plain'});
        navigator.sendBeacon(SHEET_URL, blob);
      } catch (e) {
        fetch(SHEET_URL, {
          method: "POST", mode: "no-cors", 
          headers: { "Content-Type": "text/plain;charset=UTF-8" }, 
          body: JSON.stringify(payload)
        });
      }
    }

    // --- Manejo del Clic ---
    async function handleWhatsAppClick(event) {
      event?.preventDefault?.();
      if (btn.disabled) return;
      
      btn.disabled = true;
      btn.querySelector("span").textContent = "CONECTANDO..."; 

      const selectedPhone = getRandomWhatsApp();

      const urlParams = new URLSearchParams(window.location.search);
      const ad_name = urlParams.get('utm_content') || "Organico";
      const campaign_name = urlParams.get('utm_campaign') || "Desconocido";
      const marca = urlParams.get('marca') || "default"; 

      const fbp = ensureFBP();
      const fbc = ensureFBC();
      const click_id = getOrCreateClickID();
      const event_id = "contact-" + click_id;
      const timestamp = new Date().toISOString();

      // Pixel
      if (typeof fbq !== "undefined") {
        fbq("track", "Contact", {}, { eventID: event_id });
      }

      // 1. Enviar datos al Excel
      safeSend({ 
        click_id, fbp, fbc, event_id, timestamp, 
        ad_name, campaign_name, marca, phone: selectedPhone 
      });

      // 2. Abrir WhatsApp (Mensaje con C칩digo ID)
      const message = `Hola! Quiero mi usuario. (ID: ${click_id})`;
      
      setTimeout(() => {
         window.location.href = `https://wa.me/${selectedPhone}?text=${encodeURIComponent(message)}`;
         
         // Restaurar bot칩n despu칠s de unos segundos
         setTimeout(() => {
            btn.disabled = false;
            btn.querySelector("span").textContent = "RECLAMAR MI ACCESO 游꾸";
         }, 4000);
      }, 500); 
    }

    document.addEventListener("DOMContentLoaded", () => {
      btn = document.getElementById("whatsappButton");
      if(btn) btn.addEventListener("click", handleWhatsAppClick);
    });
  </script>
</body>
</html>
